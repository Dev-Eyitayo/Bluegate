name: Random Ping to Render

on:
  schedule:
    - cron: "*/5 * * * *"

jobs:
  ping:
    runs-on: ubuntu-latest

    steps:
      - name: Wait a random number of seconds
        run: |
          WAIT=$(( RANDOM % 165 + 15 ))
          echo "Waiting $WAIT seconds..."
          sleep $WAIT

      - name: Random API endpoint ping
        run: |
          ENDPOINTS=(
            "health"
            "api/v1/blogs"
            "api/v1/events"
          )
          
          INDEX=$(( RANDOM % ${#ENDPOINTS[@]} ))
          TARGET=${ENDPOINTS[$INDEX]}

          echo "Pinging endpoint: $TARGET"
          curl -v "https://bluegate.onrender.com/$TARGET" || true
